"use strict";(self.webpackChunkevolution_motors=self.webpackChunkevolution_motors||[]).push([[16],{53016:(e,t,i)=>{i.d(t,{Z:()=>s});i(72791);var a=i(2409),l=i(49389),r=i(80184);const s=e=>{let{label:t,name:i,required:s,required_text:u}=e;return(0,r.jsx)(a.Z.Item,{label:t,name:i,rules:[{required:s,message:u}],children:(0,r.jsx)(l.default,{})})}},83386:(e,t,i)=>{i.d(t,{Z:()=>s});i(72791);var a=i(2409),l=i(66920),r=i(80184);const s=e=>{let{label:t,name:i,required:s,required_text:u}=e;return(0,r.jsx)(a.Z.Item,{label:t,name:i,rules:[{required:s,message:u}],children:(0,r.jsx)(l.Z,{rows:4})})}},43016:(e,t,i)=>{i.r(t),i.d(t,{default:()=>q});var a=i(72791),l=i(521),r=i(2409),s=i(50419),u=i(66106),n=i(30914),d=i(93086),o=i(87309),c=i(91933),m=i(27169),_=i(29677),g=i(57689),x=i(16030),v=i(46273),h=i(68747),b=i(77221),p=i(53016),Z=i(83386),j=i(80184);const{Title:f}=l.default,z={bg_image:[],title_uz:"",title_ru:"",subtitle_uz:"",subtitle_ru:"",main_title_uz:"",main_title_ru:"",context_text_uz:"",context_text_ru:"",cards:[{card_title_uz:"",card_title_ru:"",card_image:[]}]},q=()=>{const[e]=r.Z.useForm(),t=(0,g.s0)(),{editId:i}=(0,x.v9)((e=>e.editData)),l=(0,x.I0)(),[q,y]=(0,a.useState)([]),[F,S]=(0,a.useState)([]),[w,k]=(0,a.useState)(""),[I,D]=(0,a.useState)(0),{mutate:E,data:L,isLoading:P,isSuccess:V}=(0,c.useMutation)((e=>{let{url:t,formData:i}=e;return m.Z.postData(t,i)}),{onSuccess:()=>{s.ZP.success("Success")},onError:e=>{for(let t in e.response.data)s.ZP.error("".concat(t,": ").concat(e.response.data[t][0]))}}),{mutate:C,data:U,isLoading:R,isSuccess:A}=(0,c.useMutation)((e=>{let{url:t,data:i}=e;return m.Z.postData(t,i)}),{onSuccess:()=>{s.ZP.success("Success")},onError:e=>{for(let t in e.response.data)s.ZP.error("".concat(t,": ").concat(e.response.data[t][0]))}}),{isLoading:T,data:M,refetch:O,isSuccess:Q}=(0,c.useQuery)(["edit-about",i],(()=>m.Z.getDataByID("/about/about-company",i)),{enabled:!1}),{mutate:K,isLoading:B,data:J,isSuccess:N}=(0,c.useMutation)((e=>{let{url:t,data:i,id:a}=e;return m.Z.editData(t,i,a)}),{onSuccess:()=>{s.ZP.success("Success")},onError:e=>{for(let t in e.response.data)s.ZP.error("".concat(t,": ").concat(e.response.data[t][0]))}}),{mutate:H}=(0,c.useMutation)((e=>{let{url:t,ids:i}=e;return m.Z.deleteImages(t,i)}),{onSuccess:()=>s.ZP.success("Success"),onError:e=>s.ZP.error(e.message)});(0,a.useEffect)((()=>{N&&l({type:b.Pb,payload:""}),(A||N)&&t("/about")}),[U,J]),(0,a.useEffect)((()=>{""!==i&&O()}),[i]),(0,a.useEffect)((()=>{""===i&&e.setFieldsValue(z)}),[]),(0,a.useEffect)((()=>{var t,i,a;const l=[],r=[];if(void 0!==M)for(let e=0;e<M.cards.length;e++){var s,u,n,d,o,c;let t=[{uid:null===(s=M.cards[e])||void 0===s||null===(u=s.card_image)||void 0===u?void 0:u.id,name:null===(n=M.cards[e])||void 0===n||null===(d=n.card_image)||void 0===d?void 0:d.id,status:"done",url:null===(o=M.cards[e])||void 0===o||null===(c=o.card_image)||void 0===c?void 0:c.image}];const i={card_title_uz:M.cards[e].card_title_uz,card_title_ru:M.cards[e].card_title_ru,card_image:t};l.push(i),r.push(t)}const m=[{uid:null===M||void 0===M||null===(t=M.bg_image)||void 0===t?void 0:t.id,name:null===M||void 0===M||null===(i=M.bg_image)||void 0===i?void 0:i.id,status:"done",url:null===M||void 0===M||null===(a=M.bg_image)||void 0===a?void 0:a.image}];if(Q){const t={bg_image:m,title_uz:M.title_uz,title_ru:M.title_ru,subtitle_uz:M.subtitle_uz,subtitle_ru:M.subtitle_ru,main_title_uz:M.main_title_uz,main_title_ru:M.main_title_ru,context_text_uz:M.context_text_uz,context_text_ru:M.context_text_ru,cards:l};y(m),S(r),e.setFieldsValue(t)}}),[M]);(0,a.useEffect)((()=>{const t=JSON.parse(localStorage.getItem("myFormValues"));t&&(t.images=[],e.setFieldsValue(t));const i=()=>{localStorage.setItem("myFormValues",JSON.stringify(e.getFieldsValue()))};return window.addEventListener("beforeunload",i),()=>{localStorage.removeItem("editDataId"),localStorage.removeItem("myFormValues"),window.removeEventListener("beforeunload",i)}}),[]),(0,a.useEffect)((()=>{if(V&&"main"===w){var t,i,a;const e=[{uid:null===L||void 0===L||null===(t=L.images[0])||void 0===t?void 0:t.id,name:null===L||void 0===L||null===(i=L.images[0])||void 0===i?void 0:i.id,status:"done",url:null===L||void 0===L||null===(a=L.images[0])||void 0===a?void 0:a.url}];y(e),k("")}const l=[...F];if(V&&"child"===w){var r,s,u;const t=[{uid:null===L||void 0===L||null===(r=L.images[0])||void 0===r?void 0:r.id,name:null===L||void 0===L||null===(s=L.images[0])||void 0===s?void 0:s.id,status:"done",url:null===L||void 0===L||null===(u=L.images[0])||void 0===u?void 0:u.url}];l[I]=t,S(l);const i=e.getFieldsValue(),a=null===i||void 0===i?void 0:i.cards;a[I]||(a[I]={card_title_uz:"",card_title_ru:"",card_image:[]}),a[I].card_image=t,e.setFieldsValue({items:a}),k("")}}),[L]);const W=async e=>{let t=e.url;t||(t=await new Promise((t=>{const i=new FileReader;i.readAsDataURL(e.originFileObj),i.onload=()=>t(i.result)})));const i=new Image;i.src=t;const a=window.open(t);null===a||void 0===a||a.document.write(i.outerHTML)};return(0,j.jsx)("div",{children:R||T||B||P?(0,j.jsx)(_.QP,{}):(0,j.jsxs)(r.Z,{form:e,name:"basic",labelCol:{span:24},wrapperCol:{span:24},style:{maxWidth:"100%"},initialValues:z,onFinish:e=>{var t;const a=[];for(let i=0;i<e.cards.length;i++){let t="";var l,r;if(F.length>0)if(null===F[i]||(null===(l=F[i])||void 0===l?void 0:l.length)<1)t="";else t=null===(r=F[i][0])||void 0===r?void 0:r.uid;const s={card_title_uz:e.cards[i].card_title_uz,card_title_ru:e.cards[i].card_title_ru,card_image:[t]};a.push(s)}const s={title_uz:e.title_uz,title_ru:e.title_ru,subtitle_uz:e.subtitle_uz,subtitle_ru:e.subtitle_ru,main_title_uz:e.main_title_uz,main_title_ru:e.main_title_ru,context_text_uz:e.context_text_uz,context_text_ru:e.context_text_ru,bg_image:[null===(t=q[0])||void 0===t?void 0:t.uid],cards:a};Q?K({url:"/about/about-company",data:s,id:i}):C({url:"/about/about-company/",data:s})},onFinishFailed:e=>{console.log("Failed:",e)},autoComplete:"off",children:[(0,j.jsxs)(u.Z,{gutter:20,children:[(0,j.jsx)(n.Z,{span:12,children:(0,j.jsx)(p.Z,{required:!0,required_text:"Sarlavha talab qilinadi",label:"Sarlavha Uz",name:"title_uz"})}),(0,j.jsx)(n.Z,{span:12,children:(0,j.jsx)(p.Z,{required:!0,required_text:"\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u0432\u0435\u0441\u0442\u0438 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a",label:"\u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a Ru",name:"title_ru"})})]}),(0,j.jsxs)(u.Z,{gutter:20,children:[(0,j.jsx)(n.Z,{span:12,children:(0,j.jsx)(Z.Z,{required:!0,required_text:"Qo'shimcha sarlavha kiritish talab qilinada",label:"Qo'shimcha sarlavha Uz",name:"subtitle_uz"})}),(0,j.jsx)(n.Z,{span:12,children:(0,j.jsx)(Z.Z,{required:!0,required_text:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a",label:"\u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 Ru",name:"subtitle_ru"})})]}),(0,j.jsxs)(u.Z,{gutter:20,children:[(0,j.jsx)(n.Z,{span:12,children:(0,j.jsx)(Z.Z,{required:!0,required_text:"Asosiy matn sarlavha kiritish kerak",label:"Asosiy matn Uz",name:"main_title_uz"})}),(0,j.jsx)(n.Z,{span:12,children:(0,j.jsx)(Z.Z,{required:!0,required_text:"\u041e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0442\u0435\u043a\u0441\u0442 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0437\u0430\u0433\u043e\u043b\u043e\u0432\u043a\u043e\u043c.",label:"\u041e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0442\u0435\u043a\u0441\u0442 \u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 Ru",name:"main_title_ru"})})]}),(0,j.jsxs)(u.Z,{gutter:20,children:[(0,j.jsx)(n.Z,{span:12,children:(0,j.jsx)(Z.Z,{required:!0,required_text:"Asosiy matn kiritish kerak",label:"Asosiy matn Uz",name:"context_text_uz"})}),(0,j.jsx)(n.Z,{span:12,children:(0,j.jsx)(Z.Z,{required:!0,required_text:"\u0412\u0430\u043c \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u0432\u0435\u0441\u0442\u0438 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0442\u0435\u043a\u0441\u0442",label:"\u041e\u0441\u043d\u043e\u0432\u043d\u043e\u0439 \u0442\u0435\u043a\u0441\u0442 Ru",name:"context_text_ru"})})]}),(0,j.jsx)(u.Z,{gutter:20,children:(0,j.jsx)(n.Z,{span:12,children:(0,j.jsx)(r.Z.Item,{label:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u043e\u0441\u043d\u043e\u0432\u043d\u043e\u0439",name:"bg_image",rules:[{required:!0,message:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0431\u0430\u043d\u043d\u0435\u0440\u0430 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u043e."}],children:(0,j.jsx)(v.Z,{children:(0,j.jsx)(d.Z,{maxCount:1,fileList:q,listType:"picture-card",onChange:t=>{let{fileList:i}=t;if(e.setFieldsValue({bg_image:i}),0!==q.length||0===i.length){var a;const e=[null===(a=q[0])||void 0===a?void 0:a.uid];H({url:"/delete-images",ids:{image_ids:e}}),y([])}const l=new FormData;0!==i.length&&(l.append("uploaded_images",i[0].originFileObj),E({url:"/about/images/",formData:l}),k("main"))},onPreview:W,beforeUpload:()=>!1,children:q.length>0?"":"Upload"})})})})}),(0,j.jsx)(f,{level:3,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u0440\u0435\u0438\u043c\u0443\u0449\u0435\u0441\u0442\u0432\u0430"}),(0,j.jsx)(r.Z.List,{name:"cards",children:(t,i)=>{let{add:a,remove:l}=i;return(0,j.jsxs)(j.Fragment,{children:[t.map(((e,t)=>{const i=F[t]||[];return(0,j.jsxs)("div",{style:{marginBottom:20},children:[(0,j.jsxs)(u.Z,{gutter:20,children:[(0,j.jsx)(n.Z,{span:12,children:(0,j.jsx)(p.Z,{required:!0,required_text:"Karta nomi talab qilinadi",label:"Karta nomi Uz ".concat(t+1),name:[e.name,"card_title_uz"]})}),(0,j.jsx)(n.Z,{span:12,children:(0,j.jsx)(p.Z,{required:!0,required_text:"\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u0432\u0435\u0441\u0442\u0438 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043a\u0430\u0440\u0442\u044b",label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043a\u0430\u0440\u0442\u044b Ru ".concat(t+1),name:[e.name,"card_title_ru"]})})]}),(0,j.jsx)(r.Z.Item,{label:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u043a\u0430\u0440\u0442\u044b ".concat(t+1),name:[e.name,"card_image"],rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u043a\u0430\u0440\u0442\u044b"}],children:(0,j.jsx)(v.Z,{rotate:!0,children:(0,j.jsx)(d.Z,{maxCount:1,listType:"picture-card",fileList:i,onChange:e=>((e,t)=>{let{fileList:i}=t;if(D(e),F[e]||0===i.length){const t=[F[e][0].uid];H({url:"/delete-images",ids:{image_ids:t}}),F[e]=null,S(F)}const a=new FormData;0!==i.length&&(a.append("uploaded_images",i[0].originFileObj),E({url:"/about/images/",formData:a}),k("child"))})(t,e),onPreview:W,beforeUpload:()=>!1,children:i.length<1&&"+ Upload"})})}),(0,j.jsx)(h.Z,{onClick:()=>((e,t,i,a)=>{if(a===F[i]&&F.length>0){var l;const e=[null===(l=F[i][0])||void 0===l?void 0:l.uid];F.splice(i,1),H({url:"/delete-images",ids:{image_ids:e}})}t(e)})(e.name,l,t,i)})]},e.fieldKey)})),(0,j.jsx)(r.Z.Item,{children:(0,j.jsx)(o.Z,{type:"primary",onClick:()=>(t=>{let i=[];t();const a=e.getFieldsValue();null!==a&&void 0!==a&&a.cards[0]||i.push({card_title_uz:"",card_title_ru:"",card_image:[]}),e.setFieldsValue({items:i})})(a),block:!0,style:{backgroundColor:"#28a745"},children:"\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u043f\u0440\u0435\u0434\u043c\u0435\u0442"})})]})}}),(0,j.jsx)(o.Z,{type:"primary",htmlType:"submit",style:{width:"100%",marginTop:"20px"},children:Q?"Edit":"Add"})]})})}}}]);
//# sourceMappingURL=16.6557295d.chunk.js.map