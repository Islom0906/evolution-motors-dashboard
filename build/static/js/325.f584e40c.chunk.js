"use strict";(self.webpackChunkevolution_motors=self.webpackChunkevolution_motors||[]).push([[325],{325:(e,a,t)=>{t.r(a),t.d(a,{default:()=>S});var s=t(72791),l=t(2409),n=t(50419),o=t(66106),r=t(30914),i=t(49389),u=t(87309),d=t(91933),c=t(27169),m=t(29677),p=t(57689),g=t(16030),f=t(77221),h=t(7993),b=t(80184);const y={name:"",lat:""},S=()=>{const{isLoaded:e}=(0,h.Ji)({id:"google-map-script",googleMapsApiKey:"AIzaSyDt2upRTGqJ3BOGeKN1aCG5dByeOspcREk",libraries:["geometry","drawing"]}),[a]=l.Z.useForm(),t=(0,p.s0)(),{editId:S}=(0,g.v9)((e=>e.editData)),x=(0,g.I0)(),[Z,j]=(0,s.useState)({lat:null,lng:null}),[F,v]=(0,s.useState)({lat:41.311785,lng:69.279696}),{mutate:w,data:E,isLoading:I,isSuccess:C}=(0,d.useMutation)((e=>{let{url:a,data:t}=e;return c.Z.postData(a,t)}),{onSuccess:()=>{n.ZP.success("Success")},onError:e=>{n.ZP.error(e)}}),{isLoading:V,data:D,refetch:L,isSuccess:k}=(0,d.useQuery)(["edit-map",S],(()=>c.Z.getDataByID("/about/map",S)),{enabled:!1}),{mutate:P,isLoading:N,data:J,isSuccess:O}=(0,d.useMutation)((e=>{let{url:a,data:t,id:s}=e;return c.Z.editData(a,t,s)}),{onSuccess:()=>{n.ZP.success("Success")},onError:e=>{n.ZP.error(e.message)}});(0,s.useEffect)((()=>{O&&x({type:f.Pb,payload:""}),(C||O)&&t("/map")}),[E,J]),(0,s.useEffect)((()=>{""!==S&&L()}),[S]),(0,s.useEffect)((()=>{""===S&&a.setFieldsValue(y)}),[]),(0,s.useEffect)((()=>{if(k){const e={name:D.name,lat:D.lat};j({lat:Number(D.lat),lng:Number(D.lng)}),a.setFieldsValue(e)}}),[D]);(0,s.useEffect)((()=>{const e=JSON.parse(localStorage.getItem("myFormValues"));e&&(e.images=[],a.setFieldsValue(e));const t=()=>{localStorage.setItem("myFormValues",JSON.stringify(a.getFieldsValue()))};return window.addEventListener("beforeunload",t),()=>{localStorage.removeItem("editDataId"),localStorage.removeItem("myFormValues"),window.removeEventListener("beforeunload",t)}}),[]);return(0,b.jsx)("div",{children:I||V||N?(0,b.jsx)(m.QP,{}):(0,b.jsxs)(l.Z,{form:a,name:"basic",labelCol:{span:24},wrapperCol:{span:24},style:{maxWidth:"100%"},initialValues:y,onFinish:e=>{const a=new FormData;a.append("name",e.name),a.append("lat",Z.lat),a.append("lng",Z.lng),D?P({url:"/about/map",data:a,id:S}):w({url:"/about/map/",data:a})},onFinishFailed:e=>{console.log("Failed:",e)},autoComplete:"off",children:[(0,b.jsx)(o.Z,{gutter:20,children:(0,b.jsx)(r.Z,{span:24,children:(0,b.jsx)(l.Z.Item,{label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",name:"name",rules:[{required:!0,message:"\u0412\u0432\u043e\u0434 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044f \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u0435\u043d"}],children:(0,b.jsx)(i.default,{})})})}),(0,b.jsx)(o.Z,{gutter:20,children:(0,b.jsxs)(r.Z,{span:24,children:[e&&(0,b.jsx)(h.b6,{mapContainerStyle:{height:"400px",width:"100%"},zoom:12,center:F,onClick:e=>{const t={lat:e.latLng.lat(),lng:null===e||void 0===e?void 0:e.latLng.lng()};v(t),j(t),a.setFieldsValue({lat:t.lat})},children:(0,b.jsx)(h.jC,{position:Z})}),(0,b.jsx)(l.Z.Item,{label:"",name:"lat",rules:[{required:!0,message:"\u0420\u0430\u0437\u043c\u0435\u0442\u043a\u0430 \u043a\u0430\u0440\u0442\u044b \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u0430"}]})]})}),(0,b.jsx)(u.Z,{type:"primary",htmlType:"submit",style:{width:"100%",marginTop:"20px"},children:k?"Edit":"Add"})]})})}}}]);
//# sourceMappingURL=325.f584e40c.chunk.js.map