"use strict";(self.webpackChunkevolution_motors=self.webpackChunkevolution_motors||[]).push([[783],{53016:(e,t,a)=>{a.d(t,{Z:()=>l});a(72791);var r=a(2409),s=a(49389),i=a(80184);const l=e=>{let{label:t,name:a,required:l,required_text:n}=e;return(0,i.jsx)(r.Z.Item,{label:t,name:a,rules:[{required:l,message:n}],children:(0,i.jsx)(s.default,{})})}},98783:(e,t,a)=>{a.r(t),a.d(t,{default:()=>j});var r=a(72791),s=a(2409),i=a(50419),l=a(66106),n=a(30914),o=a(83734),d=a(93086),u=a(87309),c=a(91933),m=a(27169),p=a(29677),g=a(57689),f=a(16030),h=a(77221),b=a(53016),v=a(46273),x=a(80184);const Z={title_uz:"",title_ru:"",image:[],country:""},j=()=>{const[e]=s.Z.useForm(),t=(0,g.s0)(),{editId:a}=(0,f.v9)((e=>e.editData)),j=(0,f.I0)(),[y,w]=(0,r.useState)([]),{data:F,refetch:_}=(0,c.useQuery)("get-countries",(()=>m.Z.getData("/cars/countries/")),{enabled:!1}),{mutate:S,data:I,isLoading:E,isSuccess:L}=(0,c.useMutation)((e=>{let{url:t,data:a}=e;return m.Z.postData(t,a)}),{onSuccess:()=>{i.ZP.success("Success")},onError:e=>{for(let t in e.response.data)i.ZP.error("".concat(t,": ").concat(e.response.data[t][0]))}}),{isLoading:q,data:D,refetch:P,isSuccess:V}=(0,c.useQuery)(["edit-brands",a],(()=>m.Z.getDataByID("/cars/brands",a)),{enabled:!1}),{mutate:z,isLoading:C,data:k,isSuccess:O}=(0,c.useMutation)((e=>{let{url:t,data:a,id:r}=e;return m.Z.editData(t,a,r)}),{onSuccess:()=>{i.ZP.success("Success")},onError:e=>{for(let t in e.response.data)i.ZP.error("".concat(t,": ").concat(e.response.data[t][0]))}});(0,r.useEffect)((()=>{O&&j({type:h.Pb,payload:""}),(L||O)&&t("/brands")}),[I,k]),(0,r.useEffect)((()=>{""!==a&&P()}),[a]),(0,r.useEffect)((()=>{""===a&&e.setFieldsValue(Z),_()}),[]),(0,r.useEffect)((()=>{if(V){console.log(D.countries.id);const t=[{uid:D.id,name:D.id,status:"done",url:D.image}],a={title_uz:D.title_uz,title_ru:D.title_ru,image:t,country:D.countries.id};w(t),e.setFieldsValue(a)}}),[D]);(0,r.useEffect)((()=>{const t=JSON.parse(localStorage.getItem("myFormValues"));t&&(t.images=[],e.setFieldsValue(t));const a=()=>{localStorage.setItem("myFormValues",JSON.stringify(e.getFieldsValue()))};return window.addEventListener("beforeunload",a),()=>{localStorage.removeItem("editDataId"),localStorage.removeItem("myFormValues"),window.removeEventListener("beforeunload",a)}}),[]);const M=(0,r.useMemo)((()=>null===F||void 0===F?void 0:F.map((e=>({value:null===e||void 0===e?void 0:e.id,label:null===e||void 0===e?void 0:e.title_ru})))),[F]);return(0,x.jsx)("div",{children:E||q||C?(0,x.jsx)(p.QP,{}):(0,x.jsxs)(s.Z,{form:e,name:"basic",labelCol:{span:24},wrapperCol:{span:24},style:{maxWidth:"100%"},initialValues:Z,onFinish:e=>{var t;const r=new FormData;var s;(r.append("title_uz",e.title_uz),r.append("title_ru",e.title_ru),r.append("country",e.country),null!==(t=y[0])&&void 0!==t&&t.originFileObj)&&r.append("image",null===(s=y[0])||void 0===s?void 0:s.originFileObj);D?z({url:"/cars/brands",data:r,id:a}):S({url:"/cars/brands/",data:r})},onFinishFailed:e=>{console.log("Failed:",e)},autoComplete:"off",children:[(0,x.jsxs)(l.Z,{gutter:20,children:[(0,x.jsx)(n.Z,{span:12,children:(0,x.jsx)(b.Z,{required:!0,required_text:"Brand kiritishingiz kerak",label:"Brand Uz",name:"title_uz"})}),(0,x.jsx)(n.Z,{span:12,children:(0,x.jsx)(b.Z,{required:!0,required_text:"\u0412\u044b \u0434\u043e\u043b\u0436\u043d\u044b \u0432\u0432\u0435\u0441\u0442\u0438 \u0431\u0440\u0435\u043d\u0434",label:"\u0411\u0440\u0435\u043d\u0434 Ru",name:"title_ru"})}),(0,x.jsx)(n.Z,{span:24,children:(0,x.jsx)(s.Z.Item,{label:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043d\u0443",name:"country",rules:[{required:!0,message:"\u0421\u0442\u0440\u0430\u043d\u0443 \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u044b"}],wrapperCol:{span:24},children:(0,x.jsx)(o.default,{style:{width:"100%"},placeholder:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043e\u0434\u043d\u0443 \u0442\u0438\u043f\u044b",optionLabelProp:"label",options:M})})})]}),(0,x.jsx)(l.Z,{gutter:20,children:(0,x.jsx)(n.Z,{span:12,children:(0,x.jsx)(s.Z.Item,{label:"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0431\u0440\u0435\u043d\u0434\u0430",name:"image",rules:[{required:!0,message:"\u0422\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0431\u0440\u0435\u043d\u0434\u0430"}],children:(0,x.jsx)(v.Z,{rotationSlider:!0,children:(0,x.jsx)(d.Z,{maxCount:1,fileList:y,listType:"picture-card",onChange:t=>{let{fileList:a}=t;w(a),e.setFieldsValue({image:a})},onPreview:async e=>{let t=e.url;t||(t=await new Promise((t=>{const a=new FileReader;a.readAsDataURL(e.originFileObj),a.onload=()=>t(a.result)})));const a=new Image;a.src=t;const r=window.open(t);null===r||void 0===r||r.document.write(a.outerHTML)},beforeUpload:()=>!1,children:y.length>0?"":"Upload"})})})})}),(0,x.jsx)(u.Z,{type:"primary",htmlType:"submit",style:{width:"100%",marginTop:"20px"},children:V?"Edit":"Add"})]})})}}}]);
//# sourceMappingURL=783.597a7fec.chunk.js.map